code,fixed_code
"import java.sql.Connection; import java.sql.DriverManager; import java.sql.PreparedStatement; import java.sql.SQLException; public class SQLInjectionExample { public static void main(String[] args) { String userInput = ""1 OR 1=1""; try { Connection connection = DriverManager.getConnection(""jdbc:your_database_url"", ""username"", ""password""); String query = ""SELECT * FROM users WHERE id = "" + userInput; PreparedStatement statement = connection.prepareStatement(query); statement.executeQuery(); } catch (SQLException e) { e.printStackTrace(); } } }","import java.sql.Connection; import java.sql.DriverManager; import java.sql.PreparedStatement; import java.sql.SQLException; public class SQLInjectionExample { public static void main(String[] args) { String userInput = ""1""; try { Connection connection = DriverManager.getConnection(""jdbc:your_database_url"", ""username"", ""password""); String query = ""SELECT * FROM users WHERE id = ?""; PreparedStatement statement = connection.prepareStatement(query); statement.setString(1, userInput); statement.executeQuery(); } catch (SQLException e) { e.printStackTrace(); } } }"
import java.util.ArrayList; import java.util.List; public class InsecureDataStorageExample { private List<String> sensitiveData = new ArrayList<>(); public void addData(String data) { sensitiveData.add(data); } public List<String> getData() { return sensitiveData; } },"import java.util.ArrayList; import java.util.List; import javax.crypto.Cipher; import javax.crypto.KeyGenerator; import javax.crypto.SecretKey; public class SecureDataStorageExample { private List<String> sensitiveData = new ArrayList<>(); public void addData(String data) throws Exception { SecretKey key = KeyGenerator.getInstance(""AES"").generateKey(); Cipher cipher = Cipher.getInstance(""AES""); cipher.init(Cipher.ENCRYPT_MODE, key); byte[] encryptedData = cipher.doFinal(data.getBytes()); sensitiveData.add(new String(encryptedData)); } public List<String> getData() { return sensitiveData; } }"
"public class HardcodedCredentials { public static void main(String[] args) { String username = ""admin""; String password = ""password123""; System.out.println(""Login as: "" + username); } }","import java.util.Properties; import java.io.InputStream; public class ExternalizedCredentials { public static void main(String[] args) { try (InputStream input = ClassLoader.getSystemResourceAsStream(""config.properties"")) { Properties prop = new Properties(); prop.load(input); String username = prop.getProperty(""username""); String password = prop.getProperty(""password""); System.out.println(""Login as: "" + username); } catch (Exception e) { e.printStackTrace(); } } }"
"import java.util.Random; public class InsecureRandomExample { public static void main(String[] args) { Random random = new Random(); int insecureRandom = random.nextInt(); System.out.println(""Random number: "" + insecureRandom); } }","import java.security.SecureRandom; public class SecureRandomExample { public static void main(String[] args) { SecureRandom secureRandom = new SecureRandom(); int secureNumber = secureRandom.nextInt(); System.out.println(""Secure random number: "" + secureNumber); } }"
"import java.io.File; public class InsecureFilePermissions { public static void main(String[] args) { File file = new File(""sensitive_data.txt""); file.setReadable(true, false); file.setWritable(true, false); } }","import java.io.File; public class SecureFilePermissions { public static void main(String[] args) { File file = new File(""sensitive_data.txt""); file.setReadable(true, true); file.setWritable(true, true); } }"
"import java.security.SecureRandom; public class SecureRandomExample { public static void main(String[] args) { SecureRandom secureRandom = new SecureRandom(); int secureNumber = secureRandom.nextInt(); System.out.println(""Secure random number: "" + secureNumber); } }","import java.security.SecureRandom; public class SecureRandomExample { public static void main(String[] args) { SecureRandom secureRandom = new SecureRandom(); int secureNumber = secureRandom.nextInt(); System.out.println(""Secure random number: "" + secureNumber); } }"
"import java.sql.Connection; import java.sql.PreparedStatement; import java.sql.SQLException; public class SecureSQL { public static void main(String[] args) { try { Connection connection = DriverManager.getConnection(""jdbc:your_database_url"", ""username"", ""password""); String query = ""SELECT * FROM users WHERE id = ?""; PreparedStatement stmt = connection.prepareStatement(query); stmt.setInt(1, 1); stmt.executeQuery(); } catch (SQLException e) { e.printStackTrace(); } } }","import java.sql.Connection; import java.sql.PreparedStatement; import java.sql.SQLException; public class SecureSQL { public static void main(String[] args) { try { Connection connection = DriverManager.getConnection(""jdbc:your_database_url"", ""username"", ""password""); String query = ""SELECT * FROM users WHERE id = ?""; PreparedStatement stmt = connection.prepareStatement(query); stmt.setInt(1, 1); stmt.executeQuery(); } catch (SQLException e) { e.printStackTrace(); } } }"
